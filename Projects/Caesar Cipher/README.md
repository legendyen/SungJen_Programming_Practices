Split to three part: 1. Encrypt 2. Decrypt 3. Final
